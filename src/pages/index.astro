---

import Layout from "../layouts/Layout.astro";

import BentoDandD from "../components/BentoDandD.astro";
import BentoHomeMarquee from "../components/BentoHomeMarquee.astro";
import BentoHomeCiao from "../components/BentoHomeCiao.astro";
import BentoHomeLinks from "../components/BentoHomeLinks.astro";
import BentoHomeHireMe from "../components/BentoHomeHireMe.astro";
import BentoProfileCard from "../components/BentoProfileCard.astro";
import BentoHomeWhaleCard from "../components/BentoHomeWhaleCard.astro";
import Nav from "../components/Nav.astro";


---

<Layout title="Giacomo Ravetta">



    <div class="flex flex-col h-[100dvh] w-full gap-[1.6dvw] p-[1.6dvw]">

        <div class="flex items-center h-full gap-1 pl-2">
              <p class="font-inter font-black text-[2dvw] text-4xl m-0">GIACOMO RAVETTA</p>
              <p class="pipe font-inter font-black text-[2dvw] text-4xl">|</p>
          </div>

        <Nav />

        <!-- Middle section with profile and D&D -->
        <div class="flex flex-row gap-[1.6dvw] h-[64dvh]">
            <div class="flex flex-col gap-[1.6dvh] h-full w-[80%]">
                <BentoDandD  />

                <BentoHomeWhaleCard />


            </div>
            <div class="w-[40%]">
                <BentoProfileCard  />
            </div>
        </div>

        <!-- Marquee section -->

            <BentoHomeMarquee />


        <!-- Bottom row with 4 components -->
        <div class="flex gap-[1.6dvw] h-[10dvh] w-full">
             <BentoHomeLinks />
             <BentoHomeCiao/>
             <BentoHomeHireMe />


        </div>
    </div>

    <style>
    .pipe {
      animation: blink 1.5s step-end infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    </style>
</Layout>

<script>
  import { animate, stagger } from "motion";

  // Wrap animation logic in a reusable function
  function animateVisibleBrackets() {
    const containers = document.querySelectorAll(".bracket");

    const visibleContainers = Array.from(containers).filter(container => {
      const style = window.getComputedStyle(container);
      const isVisible = style.display !== 'none' && style.visibility !== 'hidden';
      return isVisible;
    });

    // Animate all elements at once (not in a loop)
    if (visibleContainers.length > 0) {
      animate(visibleContainers,
        {
          y: [-100, 50, 0],
          opacity: [0, 1],
        },
        {
          duration: 3,
          delay: stagger(1),
        }
      );
    }
  }

  // Handle window resize with debounce
  let resizeTimer;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
      animateVisibleBrackets();
    }, 250); // 250ms debounce
  });

  document.addEventListener('DOMContentLoaded', () => {

    animateVisibleBrackets();
  });
</script>
